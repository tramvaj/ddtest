<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Anti Aircraft Meme Defense</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      background: #020617;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      align-items: center;
      justify-content: flex-start;
    }

    h1 {
      margin: 16px 0 4px 0;
      font-size: 24px;
      text-align: center;
      color: #fbbf24;
    }

    .subtitle {
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 10px;
      text-align: center;
    }

    .game-container {
      background: #020617;
      border-radius: 16px;
      padding: 12px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.8);
      display: inline-block;
      margin-bottom: 16px;
    }

    canvas {
      display: block;
      background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
      border-radius: 12px;
      border: 1px solid #1f2937;
    }

    .info {
      font-size: 13px;
      color: #9ca3af;
      text-align: center;
      margin-bottom: 10px;
    }

    .info span {
      color: #22c55e;
      font-weight: 600;
    }

    footer {
      margin-top: auto;
      padding: 12px 8px 20px 8px;
      font-size: 13px;
      color: #6b7280;
      text-align: center;
    }

    footer span {
      color: #f472b6;
    }
  </style>
</head>
<body>

  <h1>Anti Aircraft Meme Defense</h1>
  <div class="subtitle">Left Right to move, Space to shoot, panic in between</div>

  <div class="info">
    Hit the flying metal birds for <span>10 points</span> each. Miss too many and they laugh at you silently.
  </div>

  <div class="game-container">
    <canvas id="game" width="800" height="500"></canvas>
  </div>

  <footer>
    Pro tip: if you blame input lag for missing, you gain <span>zero</span> extra points but one extra excuse.
  </footer>

  <script>
    (function () {
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");

      const WIDTH = canvas.width;
      const HEIGHT = canvas.height;

      const player = {
        x: WIDTH / 2,
        y: HEIGHT - 40,
        width: 40,
        height: 20,
        speed: 300
      };

      const bullets = [];
      const planes = [];

      let score = 0;
      let lastTime = 0;
      let spawnTimer = 0;
      const spawnInterval = 1.2; // seconds

      const keys = {
        left: false,
        right: false,
        space: false
      };

      let shootCooldown = 0;
      const shootDelay = 0.25; // seconds

      function spawnPlane() {
        const fromLeft = Math.random() < 0.5;
        const speed = 80 + Math.random() * 70;
        const y = 60 + Math.random() * 40;
        const width = 40;
        const height = 16;

        planes.push({
          x: fromLeft ? -width - 10 : WIDTH + 10,
          y: y,
          width: width,
          height: height,
          vx: fromLeft ? speed : -speed,
          alive: true
        });
      }

      function shoot() {
        bullets.push({
          x: player.x,
          y: player.y - 10,
          width: 4,
          height: 12,
          vy: -450,
          alive: true
        });
      }

      function update(dt) {
        if (keys.left) {
          player.x -= player.speed * dt;
        }
        if (keys.right) {
          player.x += player.speed * dt;
        }

        const halfW = player.width / 2;
        if (player.x - halfW < 10) player.x = 10 + halfW;
        if (player.x + halfW > WIDTH - 10) player.x = WIDTH - 10 - halfW;

        shootCooldown -= dt;
        if (keys.space && shootCooldown <= 0) {
          shoot();
          shootCooldown = shootDelay;
        }

        for (let i = bullets.length - 1; i >= 0; i--) {
          const b = bullets[i];
          if (!b.alive) {
            bullets.splice(i, 1);
            continue;
          }
          b.y += b.vy * dt;
          if (b.y + b.height < 0) {
            bullets.splice(i, 1);
          }
        }

        spawnTimer += dt;
        if (spawnTimer >= spawnInterval) {
          spawnTimer = 0;
          spawnPlane();
        }

        for (let i = planes.length - 1; i >= 0; i--) {
          const p = planes[i];
          if (!p.alive) {
            planes.splice(i, 1);
            continue;
          }
          p.x += p.vx * dt;
          if (p.x + p.width < -50 || p.x - p.width > WIDTH + 50) {
            planes.splice(i, 1);
          }
        }

        for (let i = planes.length - 1; i >= 0; i--) {
          const p = planes[i];
          for (let j = bullets.length - 1; j >= 0; j--) {
            const b = bullets[j];
            if (rectsOverlap(p, b)) {
              p.alive = false;
              b.alive = false;
              score += 10;
              planes.splice(i, 1);
              bullets.splice(j, 1);
              break;
            }
          }
        }
      }

      function rectsOverlap(a, b) {
        return (
          a.x < b.x + b.width &&
          a.x + a.width > b.x &&
          a.y < b.y + b.height &&
          a.y + a.height > b.y
        );
      }

      function drawBackground() {
        ctx.save();
        ctx.fillStyle = "#020617";
        ctx.fillRect(0, 0, WIDTH, HEIGHT);

        ctx.fillStyle = "#1e293b";
        ctx.fillRect(0, HEIGHT - 40, WIDTH, 40);

        ctx.strokeStyle = "#111827";
        ctx.lineWidth = 2;
        for (let i = 0; i < WIDTH; i += 40) {
          ctx.beginPath();
          ctx.moveTo(i, HEIGHT - 40);
          ctx.lineTo(i + 20, HEIGHT);
          ctx.stroke();
        }

        ctx.fillStyle = "#facc15";
        ctx.font = "20px system-ui, sans-serif";
        ctx.textAlign = "left";
        ctx.fillText("Score: " + score, 16, 30);

        ctx.fillStyle = "rgba(148, 163, 184, 0.6)";
        ctx.font = "14px system-ui, sans-serif";
        ctx.textAlign = "right";
        ctx.fillText("Arrows to move, Space to shoot", WIDTH - 16, 30);
        ctx.restore();
      }

      function drawPlayer() {
        ctx.save();
        const x = player.x;
        const y = player.y;

        ctx.fillStyle = "#0f172a";
        ctx.fillRect(x - 30, y + 10, 60, 10);

        ctx.fillStyle = "#e5e7eb";
        ctx.fillRect(x - player.width / 2, y, player.width, player.height);

        ctx.fillStyle = "#64748b";
        ctx.fillRect(x - 4, y - 16, 8, 16);

        ctx.fillStyle = "#10b981";
        ctx.beginPath();
        ctx.arc(x, y + 10, 4, 0, Math.PI * 2);
        ctx.fill();

        ctx.restore();
      }

      function drawBullets() {
        ctx.save();
        ctx.fillStyle = "#22c55e";
        bullets.forEach(b => {
          ctx.fillRect(b.x - b.width / 2, b.y, b.width, b.height);
        });
        ctx.restore();
      }

      function drawPlanes() {
        ctx.save();
        planes.forEach(p => {
          ctx.translate(p.x, p.y);

          ctx.fillStyle = "#e5e7eb";
          ctx.beginPath();
          ctx.moveTo(-p.width / 2, 0);
          ctx.lineTo(p.width / 2, 0);
          ctx.lineTo(p.width / 2 - 6, p.height);
          ctx.lineTo(-p.width / 2 + 6, p.height);
          ctx.closePath();
          ctx.fill();

          ctx.fillStyle = "#0f172a";
          ctx.fillRect(-p.width / 2 + 8, 2, p.width - 16, p.height - 6);

          ctx.fillStyle = "#38bdf8";
          ctx.beginPath();
          ctx.arc(-10, p.height / 2 + 1, 3, 0, Math.PI * 2);
          ctx.arc(0, p.height / 2 + 1, 3, 0, Math.PI * 2);
          ctx.arc(10, p.height / 2 + 1, 3, 0, Math.PI * 2);
          ctx.fill();

          ctx.fillStyle = "rgba(248, 250, 252, 0.5)";
          ctx.beginPath();
          ctx.moveTo(p.width / 2, p.height / 2);
          ctx.lineTo(p.width / 2 + 18, p.height / 2 + 4);
          ctx.quadraticCurveTo(p.width / 2 + 26, p.height, p.width / 2 + 10, p.height + 6);
          ctx.lineTo(p.width / 2, p.height);
          ctx.closePath();
          ctx.fill();

          ctx.setTransform(1, 0, 0, 1, 0, 0);
        });
        ctx.restore();
      }

      function render() {
        drawBackground();
        drawPlayer();
        drawBullets();
        drawPlanes();
      }

      function loop(timestamp) {
        if (!lastTime) lastTime = timestamp;
        const dt = (timestamp - lastTime) / 1000;
        lastTime = timestamp;

        update(dt);
        render();
        requestAnimationFrame(loop);
      }

      function handleKeyDown(e) {
        if (["ArrowLeft", "ArrowRight", " ", "Spacebar"].includes(e.key)) {
          e.preventDefault();
        }
        if (e.key === "ArrowLeft") {
          keys.left = true;
        } else if (e.key === "ArrowRight") {
          keys.right = true;
        } else if (e.key === " " || e.key === "Spacebar") {
          keys.space = true;
        }
      }

      function handleKeyUp(e) {
        if (e.key === "ArrowLeft") {
          keys.left = false;
        } else if (e.key === "ArrowRight") {
          keys.right = false;
        } else if (e.key === " " || e.key === "Spacebar") {
          keys.space = false;
        }
      }

      document.addEventListener("keydown", handleKeyDown);
      document.addEventListener("keyup", handleKeyUp);

      requestAnimationFrame(loop);
    })();
  </script>
</body>
</html>
