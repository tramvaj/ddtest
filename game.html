<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Anti Aircraft Meme Defense</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      background: #020617;
      color: #e5e7eb;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      align-items: center;
      justify-content: flex-start;
    }

    h1 {
      margin: 16px 0 4px 0;
      font-size: 24px;
      text-align: center;
      color: #fbbf24;
    }

    .subtitle {
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 10px;
      text-align: center;
    }

    .game-container {
      background: #020617;
      border-radius: 16px;
      padding: 12px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.8);
      display: inline-block;
      margin-bottom: 16px;
    }

    canvas {
      display: block;
      background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
      border-radius: 12px;
      border: 1px solid #1f2937;
    }

    .info {
      font-size: 13px;
      color: #9ca3af;
      text-align: center;
      margin-bottom: 10px;
    }

    .info span {
      color: #22c55e;
      font-weight: 600;
    }

    footer {
      margin-top: auto;
      padding: 12px 8px 20px 8px;
      font-size: 13px;
      color: #6b7280;
      text-align: center;
    }

    footer span {
      color: #f472b6;
    }
  </style>
</head>
<body>

  <h1>Anti Aircraft Meme Defense</h1>
  <div class="subtitle">Left right to move, space to shoot, panic in between</div>

  <div class="info">
    Hit the military planes for <span>10 points</span> each. The pilots are judging your aim.
  </div>

  <div class="game-container">
    <canvas id="game" width="800" height="500"></canvas>
  </div>

  <footer>
    Historical fact: shouting "pew" increases accuracy by <span>zero</span> percent.
  </footer>

  <script>
    (function () {
      const canvas = document.getElementById("game");
      const ctx = canvas.getContext("2d");

      const WIDTH = canvas.width;
      const HEIGHT = canvas.height;

      const player = {
        x: WIDTH / 2,
        y: HEIGHT - 60,
        width: 30,
        height: 28,
        speed: 300
      };

      const bullets = [];
      const planes = [];

      let score = 0;
      let lastTime = 0;
      let spawnTimer = 0;
      const spawnInterval = 1.2; // seconds

      const keys = {
        left: false,
        right: false,
        space: false
      };

      let shootCooldown = 0;
      const shootDelay = 0.25; // seconds

      function spawnPlane() {
        const fromLeft = Math.random() < 0.5;
        // 3x faster
        const speed = 3 * (80 + Math.random() * 70);
        const y = 60 + Math.random() * 40;
        const width = 60;
        const height = 22;

        planes.push({
          x: fromLeft ? -width - 10 : WIDTH + 10,
          y: y,
          width: width,
          height: height,
          vx: fromLeft ? speed : -speed,
          alive: true,
          dirLeft: !fromLeft
        });
      }

      function shoot() {
        bullets.push({
          x: player.x,
          y: player.y - 18,
          width: 4,
          height: 14,
          vy: -500,
          alive: true
        });
      }

      function update(dt) {
        if (keys.left) {
          player.x -= player.speed * dt;
        }
        if (keys.right) {
          player.x += player.speed * dt;
        }

        const halfW = player.width / 2;
        if (player.x - halfW < 20) player.x = 20 + halfW;
        if (player.x + halfW > WIDTH - 20) player.x = WIDTH - 20 - halfW;

        shootCooldown -= dt;
        if (keys.space && shootCooldown <= 0) {
          shoot();
          shootCooldown = shootDelay;
        }

        for (let i = bullets.length - 1; i >= 0; i--) {
          const b = bullets[i];
          if (!b.alive) {
            bullets.splice(i, 1);
            continue;
          }
          b.y += b.vy * dt;
          if (b.y + b.height < 0) {
            bullets.splice(i, 1);
          }
        }

        spawnTimer += dt;
        if (spawnTimer >= spawnInterval) {
          spawnTimer = 0;
          spawnPlane();
        }

        for (let i = planes.length - 1; i >= 0; i--) {
          const p = planes[i];
          if (!p.alive) {
            planes.splice(i, 1);
            continue;
          }
          p.x += p.vx * dt;
          if (p.x + p.width < -80 || p.x - p.width > WIDTH + 80) {
            planes.splice(i, 1);
          }
        }

        for (let i = planes.length - 1; i >= 0; i--) {
          const p = planes[i];
          for (let j = bullets.length - 1; j >= 0; j--) {
            const b = bullets[j];
            if (rectsOverlap(p, b)) {
              p.alive = false;
              b.alive = false;
              score += 10;
              planes.splice(i, 1);
              bullets.splice(j, 1);
              break;
            }
          }
        }
      }

      function rectsOverlap(a, b) {
        return (
          a.x - a.width / 2 < b.x + b.width &&
          a.x + a.width / 2 > b.x &&
          a.y - a.height / 2 < b.y + b.height &&
          a.y + a.height / 2 > b.y
        );
      }

      function drawBackground() {
        ctx.save();
        ctx.fillStyle = "#020617";
        ctx.fillRect(0, 0, WIDTH, HEIGHT);

        ctx.fillStyle = "#1e293b";
        ctx.fillRect(0, HEIGHT - 50, WIDTH, 50);

        ctx.strokeStyle = "#111827";
        ctx.lineWidth = 2;
        for (let i = 0; i < WIDTH; i += 40) {
          ctx.beginPath();
          ctx.moveTo(i, HEIGHT - 50);
          ctx.lineTo(i + 20, HEIGHT);
          ctx.stroke();
        }

        ctx.fillStyle = "#facc15";
        ctx.font = "20px system-ui, sans-serif";
        ctx.textAlign = "left";
        ctx.fillText("Score: " + score, 16, 30);

        ctx.fillStyle = "rgba(148, 163, 184, 0.75)";
        ctx.font = "14px system-ui, sans-serif";
        ctx.textAlign = "right";
        ctx.fillText("Arrows to move, Space to shoot", WIDTH - 16, 30);
        ctx.restore();
      }

      function drawPlayer() {
        ctx.save();
        const x = player.x;
        const y = player.y;

        // Concrete base
        ctx.fillStyle = "#111827";
        ctx.fillRect(x - 50, y + 18, 100, 20);

        // Rotating platform
        ctx.fillStyle = "#1f2937";
        ctx.beginPath();
        ctx.arc(x, y + 18, 22, 0, Math.PI, true);
        ctx.fill();

        // Gun mount
        ctx.fillStyle = "#4b5563";
        ctx.fillRect(x - 10, y - 6, 20, 22);

        // Barrel
        ctx.save();
        ctx.translate(x, y - 4);
        const barrelLength = 60;
        const barrelWidth = 8;
        ctx.fillStyle = "#9ca3af";
        ctx.fillRect(-barrelWidth / 2, -barrelLength, barrelWidth, barrelLength);

        // Muzzle brake
        ctx.fillStyle = "#e5e7eb";
        ctx.fillRect(-barrelWidth / 2 - 2, -barrelLength - 8, barrelWidth + 4, 8);
        ctx.restore();

        // Tiny gunner window
        ctx.fillStyle = "#22c55e";
        ctx.fillRect(x - 6, y, 12, 8);

        ctx.restore();
      }

      function drawBullets() {
        ctx.save();
        ctx.fillStyle = "#f97316";
        bullets.forEach(b => {
          ctx.fillRect(b.x - b.width / 2, b.y, b.width, b.height);
        });
        ctx.restore();
      }

      function drawPlanes() {
        ctx.save();
        planes.forEach(p => {
          ctx.save();
          ctx.translate(p.x, p.y);
          if (p.vx < 0) {
            ctx.scale(-1, 1); // flip when flying left
          }

          const bodyLen = p.width;
          const bodyHeight = 12;

          // Fuselage
          ctx.fillStyle = "#4b5563";
          ctx.beginPath();
          ctx.roundRect(-bodyLen / 2, -bodyHeight / 2, bodyLen, bodyHeight, 4);
          ctx.fill();

          // Nose
          ctx.fillStyle = "#9ca3af";
          ctx.beginPath();
          ctx.moveTo(bodyLen / 2, -bodyHeight / 2);
          ctx.lineTo(bodyLen / 2 + 14, 0);
          ctx.lineTo(bodyLen / 2, bodyHeight / 2);
          ctx.closePath();
          ctx.fill();

          // Tail fin
          ctx.fillStyle = "#6b7280";
          ctx.beginPath();
          ctx.moveTo(-bodyLen / 2 + 6, -bodyHeight / 2);
          ctx.lineTo(-bodyLen / 2 - 6, -bodyHeight / 2 - 12);
          ctx.lineTo(-bodyLen / 2 + 2, -bodyHeight / 2);
          ctx.closePath();
          ctx.fill();

          // Main wings
          ctx.fillStyle = "#374151";
          ctx.beginPath();
          ctx.moveTo(-10, 0);
          ctx.lineTo(-50, 18);
          ctx.lineTo(-10, 10);
          ctx.closePath();
          ctx.fill();

          ctx.beginPath();
          ctx.moveTo(10, 0);
          ctx.lineTo(50, 18);
          ctx.lineTo(10, 10);
          ctx.closePath();
          ctx.fill();

          // Underslung engines
          ctx.fillStyle = "#1f2937";
          ctx.beginPath();
          ctx.roundRect(-24, 8, 16, 8, 3);
          ctx.roundRect(8, 8, 16, 8, 3);
          ctx.fill();

          // Cockpit
          ctx.fillStyle = "#38bdf8";
          ctx.beginPath();
          ctx.ellipse(10, -8, 12, 6, 0, 0, Math.PI * 2);
          ctx.fill();

          // Roundel
          ctx.fillStyle = "#f87171";
          ctx.beginPath();
          ctx.arc(-8, 0, 5, 0, Math.PI * 2);
          ctx.fill();
          ctx.fillStyle = "#e5e7eb";
          ctx.beginPath();
          ctx.arc(-8, 0, 3, 0, Math.PI * 2);
          ctx.fill();

          ctx.restore();
        });
        ctx.restore();
      }

      function render() {
        drawBackground();
        drawPlayer();
        drawBullets();
        drawPlanes();
      }

      function loop(timestamp) {
        if (!lastTime) lastTime = timestamp;
        const dt = (timestamp - lastTime) / 1000;
        lastTime = timestamp;

        update(dt);
        render();
        requestAnimationFrame(loop);
      }

      function handleKeyDown(e) {
        if (["ArrowLeft", "ArrowRight", " ", "Spacebar"].includes(e.key)) {
          e.preventDefault();
        }
        if (e.key === "ArrowLeft") {
          keys.left = true;
        } else if (e.key === "ArrowRight") {
          keys.right = true;
        } else if (e.key === " " || e.key === "Spacebar") {
          keys.space = true;
        }
      }

      function handleKeyUp(e) {
        if (e.key === "ArrowLeft") {
          keys.left = false;
        } else if (e.key === "ArrowRight") {
          keys.right = false;
        } else if (e.key === " " || e.key === "Spacebar") {
          keys.space = false;
        }
      }

      document.addEventListener("keydown", handleKeyDown);
      document.addEventListener("keyup", handleKeyUp);

      requestAnimationFrame(loop);
    })();
  </script>
</body>
</html>
